##### Exemple 1 #####
### X - Po(3) et Y - Po(5), S = X + Y
lam <- c(1, 2)
x <- 0:20
fx <- dpois(x, lam[1])
fy <- dpois(x, lam[2])
apply(cbind(fx, fy), 2, sum) # vérif
## Code basé sur le formule théorique
fs <- sapply(x, function(k) sum(fx[0:k + 1] * fy[k:0 + 1]))
# Vérif
sum(fs)
cbind(sum(lam), sum(fs * x))
cbind(dpois(5, sum(lam)), fs[6])
## Code alternatif
mat <- outer(x, x, '+')
mat
mat == 2
## Code alternatif
mat <- outer(x, x, '+')
prop <- outer(fx, fy '*')
prop <- outer(fx, fy)
prop
sum(prop[mat == 5])
# Vérif
sum(fs)
cbind(sum(lam), sum(fs * x))
cbind(dpois(5, sum(lam)), fs[6])
## Code alternatif
mat <- outer(x, x, '+')
prop <- outer(fx, fy)
sapply(x, function(k)sum(prop[mat == k]) )
## Code alternatif
mat <- outer(x, x, '+')
prop <- outer(fx, fy)
fs <- sapply(x, function(k)sum(prop[mat == k]) )
# Vérif
sum(fs)
cbind(sum(lam), sum(fs * x))
cbind(dpois(5, sum(lam)), fs[6])
## Code alternatif
dom <- outer(x, x, '+')
fxy <- outer(fx, fy)
fs <- sapply(x, function(k) sum(fxy[dom == k]))
outer(x)
outer(x, x)
outer(x, x, "+")
### ACT-2001
## Convolution par la méthode brute
## Jérémie Barde
##### Exemple 1 #####
### X - Po(3) et Y - Po(5), S = X + Y
lam <- c(1, 2)
x <- 0:20
fx <- dpois(x, lam[1])
fy <- dpois(x, lam[2])
apply(cbind(fx, fy), 2, sum) # vérif
## Code basé sur le formule théorique
fs <- sapply(x, function(k) sum(fx[0:k + 1] * fy[k:0 + 1]))
## Code alternatif
dom <- outer(x, x, '+')
fxy <- outer(fx, fy)
fs <- sapply(x, function(k) sum(fxy[dom == k]))
# Vérif
sum(fs)
cbind(sum(lam), sum(fs * x))
cbind(dpois(5, sum(lam)), fs[6])
##### Exemple 2 #####
### Xi - Po(i/25) i in {1, 100}, S = X1 + ... + X100
i <- 1:100
lam <- i/25
x <- 0:300
ES <- sum(lam)
fx <- sapply(lam, function(i) dpois(x, i))
apply(fx, 2, sum)
fs <- sapply(x, function(k) sum(fx[0:k + 1, 1]*fx[k:0 + 1, 2]))
for (i in 3:100) {
fs <- sapply(x, function(k) sum(fs[0:k + 1]*fx[k:0 + 1, i]))
}
# Vérif
sum(fs)
cbind(ES, sum(fs * x))
cbind(dpois(210, ES), fs[211])
lam
sum(lam)
ES <- sum(lam)
fx <- sapply(lam, function(i) dpois(x, i))
apply(fx, 2, sum)
fs <- sapply(x, function(k) sum(fx[0:k + 1, 1]*fx[k:0 + 1, 2]))
for (i in 3:100) {
fs <- sapply(x, function(k) sum(fs[0:k + 1]*fx[k:0 + 1, i]))
}
# Vérif
sum(fs)
cbind(ES, sum(fs * x))
cbind(dpois(210, ES), fs[211])
