runif(5)
b <- 0.1
U <- runif(5)
qexp(U, b)
rexp(5, b)
par <- c(2, 0.5)
n <- 1000
X <- rgamma(n, par[1], par[2])
k <- 10
Fn <- function(x){
1/length(X) * sum(I(X <= x))
}
# Il existe aussi une fonction
Fm <- ecdf(X)
table <- cbind(Fn(k), Fm(k), pgamma(k, par[1], par[2]))
colnames(table) <- c("Fn(10)", "Fm(10)", "FX(10)")
table
set.seed(2022)
data <- sapply(c(10, 50, 250, 10000), function(k) rgamma(k, par[1], par[2]))
F10 <- ecdf(data[[1]])
F50 <- ecdf(data[[2]])
F250 <- ecdf(data[[3]])
F10000 <- ecdf(data[[4]])
curve(pgamma(x, par[1], par[2]), ylim = c(0, 1), xlim = c(0, 20), lwd = 2
, ylab = "F_m")
curve(F10, xlim = c(0, 20), lwd = 1, col = "blue", add = T)
curve(F50, xlim = c(0, 20), lwd = 1, col = "red", add = T)
curve(F250, xlim = c(0, 20), lwd = 1, col = "green", add = T)
curve(F10000, xlim = c(0, 20), lwd = 2, col = "pink", add = T)
legend(15, 0.8, legend=c("Théorique", "m=10", "m=50", "m=250", "m=10000"),
col=c("black", "blue", "red", "green", "pink"), lty=1:1, cex=0.8)
set.seed(2022)
m <- 5E5
Y <- rpois(m, 3)
d <- 2
# Esperance et variance
esp <- mean(Y)
var <- var(Y)
# Skewness (package moments)
ske <- 1/m * sum(((Y - esp)/(sd(Y)))^3)
ske <- skewness(Y)
# Espérance tronquée
espT <- sum(Y[Y <= 2])/m
# Stop-loss
sl <- 1/m * sum(pmax(Y - d, 0))
round(cbind(esp, var, ske, espT, sl),3)
k <- 0.99
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
m <- 1E6
k <- 0.99
X <- rgamma(m, par[1], par[2])
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
m <- 1E6
k <- 0.99
X <- rgamma(m, par[1], par[2])
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
m <- 1E6
k <- 0.99
X <- rgamma(m, par[1], par[2])
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
library(knitr)
library(actuar)
library(moments)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
runif(5)
set.seed(2022)
runif(5)
b <- 0.1
U <- runif(5)
qexp(U, b)
rexp(5, b)
par <- c(2, 0.5)
n <- 1000
X <- rgamma(n, par[1], par[2])
k <- 10
Fn <- function(x){
1/length(X) * sum(I(X <= x))
}
# Il existe aussi une fonction
Fm <- ecdf(X)
table <- cbind(Fn(k), Fm(k), pgamma(k, par[1], par[2]))
colnames(table) <- c("Fn(10)", "Fm(10)", "FX(10)")
table
set.seed(2022)
data <- sapply(c(10, 50, 250, 10000), function(k) rgamma(k, par[1], par[2]))
F10 <- ecdf(data[[1]])
F50 <- ecdf(data[[2]])
F250 <- ecdf(data[[3]])
F10000 <- ecdf(data[[4]])
curve(pgamma(x, par[1], par[2]), ylim = c(0, 1), xlim = c(0, 20), lwd = 2
, ylab = "F_m")
curve(F10, xlim = c(0, 20), lwd = 1, col = "blue", add = T)
curve(F50, xlim = c(0, 20), lwd = 1, col = "red", add = T)
curve(F250, xlim = c(0, 20), lwd = 1, col = "green", add = T)
curve(F10000, xlim = c(0, 20), lwd = 2, col = "pink", add = T)
legend(15, 0.8, legend=c("Théorique", "m=10", "m=50", "m=250", "m=10000"),
col=c("black", "blue", "red", "green", "pink"), lty=1:1, cex=0.8)
set.seed(2022)
m <- 5E5
Y <- rpois(m, 3)
d <- 2
# Esperance et variance
esp <- mean(Y)
var <- var(Y)
# Skewness (package moments)
ske <- 1/m * sum(((Y - esp)/(sd(Y)))^3)
ske <- skewness(Y)
# Espérance tronquée
espT <- sum(Y[Y <= 2])/m
# Stop-loss
sl <- 1/m * sum(pmax(Y - d, 0))
round(cbind(esp, var, ske, espT, sl),3)
k <- 0.99
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
m <- 1E6
k <- 0.99
X <- rgamma(m, par[1], par[2])
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
set.seed(2022)
m <- 1E6
a <- 3
l <- 10
k <- 0.90
X <- rpareto(m, a, l)
Fm <- ecdf(X)
VaR <- quantile(X, k)[[1]]
## TVaR
# Première façon
F1 <- 1/(1-k) * (sum(X[X > VaR])/length(X) + VaR * (Fm(VaR) - k))
# Deuxième façon
F2 <- VaR + 1/m * sum(pmax(X - VaR, 0))/(1-k)
# Troisème façon
F3 <- mean(X[X > VaR])
cbind(F1, F2, F3)
set.seed(2022)
m <- 1E6
n <- 20
p <- 0.35
k <- 0.90
N <- rbinom(m, n, p)
Fm <- ecdf(N)
VaR <- quantile(N, k)[[1]]
## TVaR
# Première façon
F1 <- 1/(1-k) * (sum(N[N > VaR])/length(N) + VaR * (Fm(VaR) - k))
# Deuxième façon
F2 <- VaR + 1/m * sum(pmax(N - VaR, 0))/(1-k)
cbind(F1, F2)
m <- 1E5
l <- 0.1
U1 <- runif(m)
U2 <- runif(m)
S <- -1/0.1 * log(U1 * U2)
EspEmp <- mean(S)
EspThe <- mgamma(1, 2, l)
cbind(EspEmp, EspThe)
library(knitr)
library(actuar)
library(moments)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
runif(5)
set.seed(2022)
runif(5)
b <- 0.1
U <- runif(5)
qexp(U, b)
rexp(5, b)
par <- c(2, 0.5)
n <- 1000
X <- rgamma(n, par[1], par[2])
k <- 10
Fn <- function(x){
1/length(X) * sum(I(X <= x))
}
# Il existe aussi une fonction
Fm <- ecdf(X)
table <- cbind(Fn(k), Fm(k), pgamma(k, par[1], par[2]))
colnames(table) <- c("Fn(10)", "Fm(10)", "FX(10)")
table
set.seed(2022)
data <- sapply(c(10, 50, 250, 10000), function(k) rgamma(k, par[1], par[2]))
F10 <- ecdf(data[[1]])
F50 <- ecdf(data[[2]])
F250 <- ecdf(data[[3]])
F10000 <- ecdf(data[[4]])
curve(pgamma(x, par[1], par[2]), ylim = c(0, 1), xlim = c(0, 20), lwd = 2
, ylab = "F_m")
curve(F10, xlim = c(0, 20), lwd = 1, col = "blue", add = T)
curve(F50, xlim = c(0, 20), lwd = 1, col = "red", add = T)
curve(F250, xlim = c(0, 20), lwd = 1, col = "green", add = T)
curve(F10000, xlim = c(0, 20), lwd = 2, col = "pink", add = T)
legend(15, 0.8, legend=c("Théorique", "m=10", "m=50", "m=250", "m=10000"),
col=c("black", "blue", "red", "green", "pink"), lty=1:1, cex=0.8)
set.seed(2022)
m <- 5E5
Y <- rpois(m, 3)
d <- 2
# Esperance et variance
esp <- mean(Y)
var <- var(Y)
# Skewness (package moments)
ske <- 1/m * sum(((Y - esp)/(sd(Y)))^3)
ske <- skewness(Y)
# Espérance tronquée
espT <- sum(Y[Y <= 2])/m
# Stop-loss
sl <- 1/m * sum(pmax(Y - d, 0))
round(cbind(esp, var, ske, espT, sl),3)
k <- 0.99
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
m <- 1E6
k <- 0.99
X <- rgamma(m, par[1], par[2])
Empirique <- quantile(X, k)
Theorique <- qgamma(k, par[1], par[2])
cbind(Empirique, Theorique)
set.seed(2022)
m <- 1E6
a <- 3
l <- 10
k <- 0.90
X <- rpareto(m, a, l)
Fm <- ecdf(X)
VaR <- quantile(X, k)[[1]]
## TVaR
# Première façon
F1 <- 1/(1-k) * (sum(X[X > VaR])/length(X) + VaR * (Fm(VaR) - k))
# Deuxième façon
F2 <- VaR + 1/m * sum(pmax(X - VaR, 0))/(1-k)
# Troisème façon
F3 <- mean(X[X > VaR])
cbind(F1, F2, F3)
set.seed(2022)
m <- 1E6
n <- 20
p <- 0.35
k <- 0.90
N <- rbinom(m, n, p)
Fm <- ecdf(N)
VaR <- quantile(N, k)[[1]]
## TVaR
# Première façon
F1 <- 1/(1-k) * (sum(N[N > VaR])/length(N) + VaR * (Fm(VaR) - k))
# Deuxième façon
F2 <- VaR + 1/m * sum(pmax(N - VaR, 0))/(1-k)
cbind(F1, F2)
m <- 1E5
l <- 0.1
U1 <- runif(m)
U2 <- runif(m)
S <- -1/0.1 * log(U1 * U2)
EspEmp <- mean(S)
EspThe <- mgamma(1, 2, l)
cbind(EspEmp, EspThe)
set.seed(2022)
m <- 1E6
p <- 0.75
I <- sapply(1:10, function(i) rbinom(m, 1, p))
S <- rowSums(I)
EspEmp <- mean(S)
EspThe <- sum(dbinom(0:10, 10, p) * 0:10)
cbind(EspEmp, EspThe)
m <- 1E6
X <- rgamma(m, 3, 0.5)
Y <- rpareto(m, 3, 10)
S <- X + Y
Fm <- ecdf(S)
Fm(25)
lam <- sample(c(4, 9), m, replace = TRUE, prop = c(5/7, 2/7))
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
lam
m <- 1E6
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
Slam <- rpois(m, lam)
Empirique <- mean(Slam)
Empirique
m <- 1E6
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
Slam <- rpois(m, lam)
Empirique <- mean(Slam)
Theorique <- 5/7 * 4 + 2/7 * 9
m <- 1E6
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
Slam <- rpois(m, lam)
Empirique <- mean(Slam)
Theorique <- 5/7 * 4 + 2/7 * 9
cbind(Empirique, Theorique)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <-
cbind(Empirique, Theorique)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- "lol"
cbind(Empirique, Theorique)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- 2
cbind(Empirique, Theorique)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1)
cbind(Empirique, Theorique)
m <- 1E6
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
Slam <- rpois(m, lam)
Empirique <- mean(Slam)
Theorique <- 5/7 * 4 + 2/7 * 9
round(cbind(Empirique, Theorique),3)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1)
round(cbind(Empirique, Theorique),3)
m <- 1E6
lam <- sample(c(4, 9), m, replace = TRUE, prob = c(5/7, 2/7))
Slam <- rpois(m, lam)
Empirique <- mean(Slam)
Theorique <- 5/7 * 4 + 2/7 * 9
round(cbind(Empirique, Theorique),4)
m <- 1E6
a <- 2
b <- 0.5
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1)
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(Fm)
curve(Fm, ylim = c(0,1))
curve(Fm, ylim = c(0,1), xlim = c(0, 100))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 20))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 15))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 10))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 7))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 8))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 5))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 3))
m <- 1E6
a <- 2
b <- 6
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1) # Pareto
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 3))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 300))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 30))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 90))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 60))
Fm <- ecdf(Slam)
curve(Fm, ylim = c(0,1), xlim = c(0, 60), col = "blue", add = T)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60), col = "blue")
curve(Fm, add = T)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
m <- 1E3
a <- 2
b <- 6
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1) # Pareto
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
m <- 1E2
a <- 2
b <- 6
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1) # Pareto
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
m <- 1E3
a <- 2
b <- 6
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1) # Pareto
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(15, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(50, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(50, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(40, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
m <- 1E6
a <- 2
b <- 6
lam <- rgamma(m, a, b)
Slam <- rexp(m, lam)
Empirique <- mean(Slam)
Theorique <- b/(a-1) # Pareto
round(cbind(Empirique, Theorique),4)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2 , col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 2, ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 3, ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 4, ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 4, col = "red", ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 4, col = "red", ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2,col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("black", "blue"), lty=1:1, cex=0.8)
Fm <- ecdf(Slam)
curve(ppareto(x, a, b), lwd = 4, col = "red", ylim = c(0,1), xlim = c(0, 60))
curve(Fm, add = T, lwd = 2,col = "blue")
legend(45, 0.8, legend=c("Pareto", "Mélange"),
col=c("red", "blue"), lty=1:1, cex=0.8)
